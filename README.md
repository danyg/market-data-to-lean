# Market Data to LEAN

This project converts data from a stock market data source to the Quantconnect lean format.

At the moment only uses Alpaca as data source.

If you would like to create a different data source, the script `data-to-lean.py` expects a csv in the following format in the folder `input_data`:

```csv
time,open,high,low,close,volume
[Date ISO Time],[Open $],[High $],[Low $],[Close $],[Volume]
```

**Example**:

```csv
time,open,high,low,close,volume
2016-01-01 00:00:00+00:00,105.43,105.43,105.43,105.43,175
2016-01-01 00:01:00+00:00,105.4,105.4,105.4,105.4,505
2016-01-01 00:04:00+00:00,105.4,105.4,105.4,105.4,185
2016-01-01 00:10:00+00:00,105.4,105.4,105.4,105.4,500
2016-01-01 00:13:00+00:00,105.41,105.41,105.41,105.41,338
2016-01-01 00:15:00+00:00,105.41,105.41,105.4,105.4,950
2016-01-01 00:17:00+00:00,105.4001,105.4001,105.4,105.4,671
2016-01-01 00:36:00+00:00,105.41,105.41,105.41,105.41,500
2016-01-01 00:37:00+00:00,105.4,105.46,105.4,105.46,300
2016-01-01 00:38:00+00:00,105.46,105.47,105.46,105.47,1000
2016-01-01 00:47:00+00:00,105.48,105.5,105.48,105.48,1599
2016-01-01 00:49:00+00:00,105.51,105.51,105.5099,105.5099,400
2016-01-01 00:51:00+00:00,105.42,105.5,105.4,105.5,1282
2016-01-01 00:54:00+00:00,105.42,105.42,105.4,105.4,955
2016-01-01 00:55:00+00:00,105.42,105.43,105.42,105.43,600
2016-01-01 00:57:00+00:00,105.3601,105.46,105.36,105.46,1686
```

## Secrets

It uses a custom way of storing secrets that works for me, you can get it from here [TODO LINK TO SECRETS REPO](https://www.github.com/danyg) and with it create your secrets like this

```

```

OR just do the following changes

remove the following lines

```python
sys.path.append("/home/danyg/.secrets")
from dgsecrets import getSecret
```

Replace the following lines for your key and secret

```python
ALPACA_API_KEY = getSecret("alpaca.paper.key")
ALPACA_API_SECRET = getSecret("alpaca.paper.secret")
```

## Data

### Expected

#### Daily

```csv
19980102 00:00,973100,975300,965300,973600,2150000
19980105 00:00,978400,984400,967800,977500,4030800
19980106 00:00,972500,972800,961900,966300,2821800
19980107 00:00,960900,965000,952200,964700,5225400
19980108 00:00,963100,963100,955000,957800,3249100
19980109 00:00,952500,955000,919100,924700,10000200
19980112 00:00,911300,941900,909100,940600,11953200
19980113 00:00,946300,956300,942200,952200,5006400
19980114 00:00,956900,959700,947200,958100,3738000
19980115 00:00,955000,957500,948100,949400,2726400
19980116 00:00,962500,966900,956600,962300,4185400
19980120 00:00,966900,980000,965000,980000,4373400
19980121 00:00,972200,976900,961600,971600,4526300
19980122 00:00,961600,968800,958800,963000,4484300
19980123 00:00,965000,967800,950000,956600,6231300
19980126 00:00,963800,967300,937500,957500,4280800
19980127 00:00,958100,980000,956600,970000,6639000
19980128 00:00,974100,981100,971700,978800,4089900
19980129 00:00,978400,995600,975600,987500,7706300
19980130 00:00,987800,989700,980000,983100,3333000
19980202 00:00,999100,1005000,997500,1002500,5587200
19980203 00:00,1000000,1008100,997200,1006900,2656800
```

#### Hourly

```csv
19980102 09:00,973100,975300,970300,970300,384500
19980102 10:00,970200,971300,965300,970500,585900
19980102 11:00,969100,972200,968800,970000,147900
19980102 12:00,970000,972200,970000,971300,162200
19980102 13:00,972200,972200,968800,969100,247500
19980102 14:00,968800,970600,965300,968400,286800
19980102 15:00,967500,973800,967500,973600,335200
19980105 09:00,978400,979700,974700,976600,775200
19980105 10:00,976300,982500,975600,979700,570600
19980105 11:00,980000,984400,979400,984100,547200
19980105 12:00,984100,984100,979100,980900,402500
19980105 13:00,980900,980900,973100,975000,497700
19980105 14:00,975000,975300,967800,975300,838700
19980105 15:00,975300,977500,970300,977500,398900
19980106 09:00,972500,972800,967500,970600,545500
19980106 10:00,970600,972800,966300,970900,484100
19980106 11:00,970900,970900,965000,965000,419300
19980106 12:00,966300,968400,965300,968400,171900
19980106 13:00,968800,970600,966300,970600,188500
19980106 14:00,970600,971600,965300,967800,269200
19980106 15:00,968100,968800,961900,966300,743300
19980107 09:00,960900,964400,960000,962500,366800
19980107 10:00,963100,963400,957500,957500,585500
19980107 11:00,957500,959400,955300,958800,467900
19980107 12:00,956900,957800,954400,955000,572400
```

#### Minute

```csv
15300000,6448000,6448000,6448000,6448000,90
17040000,6455000,6455000,6455000,6455000,10
18000000,6455000,6455000,6455000,6455000,10
18600000,6455000,6455000,6455000,6455000,198
19200000,6455000,6455000,6455000,6455000,18
21780000,6455000,6455000,6454600,6454600,100
22560000,6455600,6455600,6455000,6455000,6
22800000,6454800,6454800,6454800,6454800,6
22860000,6455000,6456000,6455000,6456000,74
23640000,6456000,6456000,6456000,6456000,100
24540000,6456000,6456000,6456000,6456000,51
25200000,6457500,6457500,6457500,6457500,100
25260000,6457500,6457500,6457500,6457500,10
25320000,6457500,6459300,6457500,6457500,59
25380000,6458400,6458400,6458400,6458400,3
25500000,6458400,6459100,6458400,6459100,100
25740000,6460000,6460000,6460000,6460000,400
25800000,6460000,6465000,6460000,6465000,497
25860000,6463100,6465000,6463100,6465000,300
25920000,6465000,6465000,6465000,6465000,100
25980000,6464800,6464800,6464800,6464800,5
26100000,6464400,6464400,6463000,6463000,26
26160000,6464500,6464500,6463600,6463600,707
26220000,6463000,6466300,6463000,6466300,320
26280000,6466300,6467000,6466300,6467000,1025
```
